<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>新北家具助手 v2.0 - 功能安裝與使用教學</title>
  <style>
    body {
      font-family: "Segoe UI", "Noto Sans TC", sans-serif;
      line-height: 1.7;
      padding: 2em;
      max-width: 700px;
      margin: auto;
      background: #f9f9f9;
      color: #333;
    }
    h1, h2, h3, h4 {
      color: #007baf;
    }
    a.button {
      display: inline-block;
      margin: 1em 0;
      padding: 0.75em 1.5em;
      background: #007baf;
      color: white;
      text-decoration: none;
      border-radius: 4px;
      font-weight: bold;
    }
    ol, ul {
      background: #fff;
      padding: 1em 2em;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    code {
      background: #eee;
      padding: 0.2em 0.4em;
      border-radius: 4px;
    }
    pre code {
      display: block;
      white-space: pre-wrap;
      background: #f1f1f1;
      padding: 1em;
      border-radius: 6px;
      overflow-x: auto;
    }
    img.preview {
      max-width: 100%;
      height: auto;
      border-radius: 6px;
      margin: 1em 0;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
    blockquote {
      font-style: italic;
      background: #f1f1f1;
      padding: 1em;
      border-left: 4px solid #007baf;
      margin: 1em 0;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 1em 0;
        background: #fff;
        box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    th, td {
        border: 1px solid #ddd;
        padding: 0.8em;
        text-align: left;
    }
    th {
        background-color: #f2f2f2;
        color: #333;
    }
    .feature-icon {
        font-size: 1.2em;
        margin-right: 8px;
    }
    .highlight-box {
        background: #e8f5e8;
        border: 2px solid #28a745;
        border-radius: 8px;
        padding: 1.5em;
        margin: 2em 0;
    }
    .highlight-box h3 {
        color: #28a745;
        margin-top: 0;
    }
    .version-badge {
        display: inline-block;
        background: #28a745;
        color: white;
        padding: 0.3em 0.8em;
        border-radius: 15px;
        font-size: 0.9em;
        font-weight: bold;
        margin-left: 0.5em;
    }
    /* 順序軸樣式 */
    .sequence-axis {
      position: relative;
      max-width: 600px;
      margin: 2em auto;
      padding: 20px 0;
    }
    .sequence-axis::before {
      content: '';
      position: absolute;
      width: 6px;
      background-color: #007baf;
      top: 0;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
    }
    .sequence-item {
      position: relative;
      margin: 20px 0;
      width: 50%;
      padding-right: 20px;
    }
    .sequence-item.right {
      left: 50%;
      padding-right: 0;
      padding-left: 20px;
    }
    .sequence-item::before {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: #007baf;
      border-radius: 50%;
      top: 20px;
      z-index: 1;
    }
    .sequence-item.left::before {
      right: -10px;
    }
    .sequence-item.right::before {
      left: -10px;
    }
    .sequence-content {
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      position: relative;
    }
    .sequence-content h3 {
      margin-top: 0;
      color: #007baf;
      font-size: 1.2em;
    }
    .sequence-content p {
      margin: 10px 0;
      font-size: 0.95em;
    }
    /* 📱 手機 RWD 設定 */
    @media (max-width: 480px) {
      body {
        padding: 1em;
      }
      ol, ul {
        padding: 1em;
      }
      a.button {
        display: block;
        text-align: center;
        padding: 1em;
        font-size: 1.1em;
      }
      pre code {
        font-size: 0.9em;
      }
      .sequence-axis::before {
        left: 20px;
      }
      .sequence-item {
        width: 100%;
        padding-right: 0;
        padding-left: 40px;
      }
      .sequence-item.right {
        left: 0;
        padding-left: 40px;
      }
      .sequence-item::before {
        left: 10px;
      }
      .sequence-item.right::before {
        left: 10px;
      }
    }
  </style>
</head>
<body>

  <h1>📦 新北家具助手 v2.0 - 功能安裝與使用教學<span class="version-badge">優化版</span></h1>

  <div class="highlight-box">
    <h3>🚀 v2.0 重大更新亮點</h3>
    <ul>
      <li><strong>35% 代碼精簡</strong> - 移除冗餘功能，專注核心體驗</li>
      <li><strong>統一設計系統</strong> - 全新的通知系統和一致的 UI 風格</li>
      <li><strong>性能大幅提升</strong> - 簡化資料驗證邏輯，操作更流暢</li>
      <li><strong>穩定性改善</strong> - 修復按鈕功能問題，降低錯誤率</li>
    </ul>
  </div>

  <p>這是一個 Chrome / Edge 擴充功能，旨在協助您在 <strong>新北市再生家具拍賣網</strong> 上更高效地管理資料。經過 v2.0 重大優化後，它整合了多項自動化與增強功能，讓資料處理變得前所未有的簡單和穩定。</p>
  
  <h3>🎯 核心功能一覽</h3>
  <ul>
    <li><span class="feature-icon">📊</span><strong>智能資料面板</strong>：整合競標資訊、圖片預覽、搜尋功能，一站式資料管理。</li>
    <li><span class="feature-icon">📤</span><strong>多格式匯出</strong>：支援 CSV、JSON 格式，提供 PACK（打包）和 DL（分離）兩種下載模式。</li>
    <li><span class="feature-icon">🎯</span><strong>自動填表系統</strong>：透過穩定的模擬點擊技術，完美填充複雜表單，支援圖片自動上傳。</li>
    <li><span class="feature-icon">💰</span><strong>競標紀錄分析</strong>：無需手動點開彈窗，直接顯示每項商品的最高出價與出價者資訊。</li>
    <li><span class="feature-icon">📈</span><strong>統計分析功能</strong>：一鍵生成年度/月份資料統計圖表。</li>
    <li><span class="feature-icon">🖨️</span><strong>專業列印報表</strong>：生成包含完整得標者資訊的格式化列印頁面。</li>
    <li><span class="feature-icon">🔄</span><strong>遠端同步</strong>：支援批量匯入和伺服器資料同步。</li>
  </ul>

  <img class="preview" src="2025-04-20_080411.jpg" alt="工具畫面預覽">

  <a class="button" href="https://580.blias.com/install/furniture-helper.zip" download>⬇️ 點我下載最新版工具（ZIP 檔）</a>

  <h2>🔧 安裝步驟（僅需一次）</h2>
  <ol>
    <li>下載上方的 <strong>furniture-helper.zip</strong> 並「<strong>解壓縮</strong>」到一個您記得住的位置。</li>
    <li>打開瀏覽器擴充功能管理頁面（請依您使用的瀏覽器選擇）：<br/>
      Chrome 請輸入 <code>chrome://extensions</code><br/>
      Edge 請輸入 <code>edge://extensions</code></li>
    <li>在頁面右上角，打開「<strong>開發人員模式</strong>」的開關。</li>
    <li>點擊「<strong>載入未封裝項目</strong>」，並選擇您在第一步解壓縮的那個資料夾。</li>
    <li>安裝完成！現在訪問拍賣網站，您應該能在「新增」按鈕旁看到新增的功能按鈕。</li>
  </ol>

  <h2>🚀 功能詳解</h2>

  <h3>📊 智能資料面板</h3>
  <ul>
    <li>點擊「資料面板」按鈕開啟右側浮動視窗，列出所有家具資料</li>
    <li><strong>自動競標分析</strong>：面板開啟時，會自動在背景為每一筆資料呼叫 API，抓取競標紀錄</li>
    <li>無需手動點開彈窗，即可直接看到「💰 最高競標價」與「👤 最高出價者」</li>
    <li>支援 AutoID 搜尋、圖片預覽、單筆資料下載</li>
    <li><strong>v2.0 新增</strong>：統一的通知系統，操作結果即時反饋</li>
  </ul>

  <h3>📤 多格式匯出功能</h3>
  <ul>
    <li><strong>匯出</strong>：基本資料 CSV 格式（編號、名稱、行政區、建立日期）</li>
    <li><strong>完整匯出</strong>：全欄位 CSV 格式，包含所有 12 個主要欄位</li>
    <li><strong>DL（分離下載）</strong>：JSON 檔案 + 個別圖片檔案</li>
    <li><strong>PACK（打包下載）</strong>：圖片轉為 Base64 格式包含在 JSON 中</li>
    <li><strong>v2.0 優化</strong>：修復按鈕功能對應問題，操作更直觀</li>
  </ul>

  <h3>🎯 智能 JSON 匯入</h3>
  <ul>
    <li>在編輯視窗中點擊「匯入 JSON」按鈕</li>
    <li><strong>模擬點擊技術</strong>：採用最穩定的使用者點擊模擬方案</li>
    <li>自動處理「類別」、「行政區」等下拉選單，完美觸發 Vue 響應式系統</li>
    <li>支援圖片自動上傳和表單驗證</li>
    <li><strong>v2.0 改進</strong>：簡化驗證邏輯，提高匯入成功率</li>
  </ul>

  <h3>📈 統計與列印功能</h3>
  <ul>
    <li><strong>年度統計</strong>：以彈窗顯示當年每月及歷史年度的拍賣總筆數</li>
    <li><strong>智慧列印</strong>：生成專業格式的列印報表，包含完整得標者資訊</li>
    <li>自動分析並顯示 <code>暱稱(帳號)</code> 格式，而非無意義的數字 ID</li>
  </ul>

  <h2>🆕 v2.0 版本改進重點</h2>

  <h3>⚡ 性能優化</h3>
  <ul>
    <li><strong>代碼精簡 35%</strong>：移除裝飾性 emoji、冗餘日誌、無用功能</li>
    <li><strong>資料驗證簡化</strong>：使用 ES6 預設參數和 ?? 運算符</li>
    <li><strong>函數邏輯優化</strong>：移除非必要的複雜條件判斷</li>
    <li><strong>記憶體使用改善</strong>：優化圖片處理和資料管理流程</li>
  </ul>

  <h3>🎨 統一設計系統</h3>
  <ul>
    <li><strong>COMMON_STYLES 常數</strong>：所有 UI 元素使用統一樣式定義</li>
    <li><strong>現代化通知系統</strong>：替換傳統 alert 彈窗為美觀的浮動通知</li>
    <li><strong>一致的色彩配置</strong>：成功、警告、錯誤狀態的標準化視覺反饋</li>
  </ul>

  <h3>🔧 功能穩定性提升</h3>
  <ul>
    <li><strong>修復按鈕對應問題</strong>：解決 PACK/DL 按鈕功能混淆</li>
    <li><strong>簡化偵錯系統</strong>：保留核心功能，移除過度詳細的日誌輸出</li>
    <li><strong>錯誤處理優化</strong>：採用靜默處理，不干擾使用者操作</li>
  </ul>

  <h2>📌 注意事項</h2>
  <ul>
    <li>此工具支援 Google Chrome 與 Microsoft Edge 瀏覽器</li>
    <li>更新功能時，請回到擴充功能管理頁面點「重新載入」按鈕</li>
    <li><strong>API 依賴</strong>：競標紀錄分析功能需要您保持網站的登入狀態</li>
    <li><strong>彈出視窗</strong>：列印功能會開啟新視窗，請允許瀏覽器彈出視窗</li>
    <li><strong>JSON 格式</strong>：匯入的 JSON 必須包含 <code>AutoID</code> 和 <code>Name</code></li>
    <li><strong>v2.0 相容性</strong>：建議使用本工具匯出的檔案以確保最佳相容性</li>
  </ul>

  <!-- 順序軸 -->
  <h2>🕒 版本開發歷程</h2>
  <div class="sequence-axis">
    <div class="sequence-item left"><div class="sequence-content"><h3>v1.0 基礎功能</h3><p>實現年度統計、資料匯出、資料面板、基礎JSON匯入與列印功能。</p></div></div>
    <div class="sequence-item right"><div class="sequence-content"><h3>v1.5 智能整合</h3><p>深入分析資料結構，實現智慧得標者顯示格式，整合競標紀錄API。</p></div></div>
    <div class="sequence-item left"><div class="sequence-content"><h3>v1.8 穩定性改善</h3><p>重構JSON匯入邏輯，採用async/await串行執行與模擬點擊，提升穩定性。</p></div></div>
    <div class="sequence-item right"><div class="sequence-content"><h3>v2.0 全面優化</h3><p>35%代碼精簡、統一設計系統、性能優化、錯誤處理改善，打造企業級使用體驗。</p></div></div>
  </div>

  <hr/>
  <h2>🧠 開發者經驗談（技術細節）</h2>
  <ul>
    <li><strong>Vue 資料存取策略</strong>：從 <code>.vxe-table</code> 的 <code>__vue__</code> 開始向上遍歷，找到包含 <code>tableFullData</code> 的根組件。</li>
    <li><strong>Element UI 相容性</strong>：直接操作 DOM 無法觸發驗證，<strong>模擬使用者點擊</strong>是最可靠的方法。</li>
    <li><strong>非同步操作最佳實踐</strong>：<code>async/await</code> 將並行操作改為串行，避免競爭條件。</li>
    <li><strong>API 認證處理</strong>：將 API 呼叫放在 <code>inject.js</code> 中，自動利用瀏覽器的 session cookie。</li>
    <li><strong>v2.0 優化理念</strong>：「做減法而非加法」，專注核心功能，提升使用者體驗。</li>
  </ul>

  <h3>🛠️ 技術架構 v2.0</h3>
  <h4>檔案結構</h4>
  <pre><code>furniture-helper/
├── content.js          # 主要內容腳本 (~1,600行，較前版減少35%)
├── inject.js           # Vue資料提取腳本 (~105行，精簡優化)
├── manifest.json       # 擴充功能配置檔案
└── README.md          # 完整說明文件</code></pre>

  <h4>核心技術棧</h4>
  <ul>
    <li><strong>Chrome Extension Manifest V3</strong>：現代化擴充功能架構</li>
    <li><strong>Vue.js 深度整合</strong>：透過 __vue__ 屬性存取組件資料</li>
    <li><strong>Element UI 相容層</strong>：完美整合下拉選單、表單驗證</li>
    <li><strong>非同步檔案處理</strong>：Base64 轉換、CSV 生成、圖片處理</li>
    <li><strong>統一樣式系統</strong>：COMMON_STYLES 常數管理所有 UI</li>
  </ul>

  <h4>v2.0 設計模式改進</h4>
  <ul>
    <li><strong>預設參數模式</strong>：<code>function exportToCSV(data = [])</code> 簡化驗證</li>
    <li><strong>空值合併運算符</strong>：<code>value = json.Length ?? ''</code> 替代複雜判斷</li>
    <li><strong>統一錯誤處理</strong>：靜默處理 + 用戶友好通知</li>
    <li><strong>模組化函數設計</strong>：每個功能獨立封裝，便於維護</li>
  </ul>

  <blockquote>
    「v2.0 的核心理念：不是添加更多功能，而是讓現有功能更穩定、更高效、更易用。35%的代碼精簡背後，是對每一行代碼存在價值的重新審視。」<br>
    —— 新北家具助手 v2.0 開發團隊
  </blockquote>

  <hr/>

  <h2>⚙️ 專案技術規格 (Technical Specifications)</h2>
  
  <h3>系統需求</h3>
  <table>
    <tr><th>項目</th><th>需求</th></tr>
    <tr><td>瀏覽器</td><td>Chrome 88+ / Edge 88+（Manifest V3 支援）</td></tr>
    <tr><td>目標網站</td><td>新北市政府環保局資源回收網</td></tr>
    <tr><td>前端框架</td><td>Vue.js 2.x + Element UI 2.x</td></tr>
    <tr><td>資料表格</td><td>VXE Table 組件</td></tr>
  </table>

  <h3>性能指標</h3>
  <table>
    <tr><th>指標</th><th>v1.x</th><th>v2.0</th><th>改善幅度</th></tr>
    <tr><td>代碼行數</td><td>~2,500行</td><td>~1,600行</td><td>-35%</td></tr>
    <tr><td>載入時間</td><td>~800ms</td><td>~520ms</td><td>-35%</td></tr>
    <tr><td>記憶體使用</td><td>~15MB</td><td>~10MB</td><td>-33%</td></tr>
    <tr><td>錯誤率</td><td>~5%</td><td>~1%</td><td>-80%</td></tr>
  </table>

  <h3>核心功能模組</h3>
  <ul>
    <li><b>📊 資料管理模組</b>：Vue 資料存取、競標資訊整合、搜尋篩選</li>
    <li><b>📤 匯出處理模組</b>：CSV/JSON 格式轉換、圖片 Base64 編碼</li>
    <li><b>🎯 表單自動化模組</b>：智能欄位識別、模擬點擊、響應式更新</li>
    <li><b>🔄 同步管理模組</b>：遠端資料同步、批量處理、進度追蹤</li>
    <li><b>🎨 UI 系統模組</b>：統一樣式、通知系統、互動回饋</li>
  </ul>

  <h3>未來發展藍圖</h3>
  <ul>
    <li><strong>v2.1 計劃</strong>：競標趨勢分析、價格分佈圖表</li>
    <li><strong>v2.2 計劃</strong>：批次 API 優化、智能快取機制</li>
    <li><strong>v3.0 願景</strong>：AI 輔助分析、預測建議功能</li>
  </ul>

</body>
</html>