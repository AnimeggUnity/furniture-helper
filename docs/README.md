# 家具競標管理工具 - Chrome 擴充功能

一個專為新北市政府環保局資源回收網家具競標系統設計的 Chrome 擴充功能，提供數據管理、批量操作和自動化填表等功能。

## 📋 功能概覽

### 🎯 核心功能
- **資料面板**: 即時顯示家具競標資料，支援搜尋和篩選
- **批量匯出**: 支援 CSV 格式匯出，包含基本資料和完整資料
- **智能填表**: 自動填入產品資訊，支援圖片上傳和表單驗證
- **遠端同步**: 與伺服器同步資料，支援批量匯入
- **統計分析**: 按月份和年份統計競標資料

### 🔧 輔助功能
- **競標查詢**: 自動查詢每筆資料的競標記錄和最高出價
- **圖片預覽**: 內建圖片預覽功能
- **通知系統**: 統一的操作結果通知
- **列印功能**: 格式化列印競標資料

## 🚀 安裝方式

1. 下載擴充功能檔案
2. 開啟 Chrome 瀏覽器
3. 進入 `chrome://extensions/`
4. 開啟「開發人員模式」
5. 點擊「載入未封裝項目」
6. 選擇擴充功能資料夾

## 💡 使用方法

### 資料面板操作
1. 進入家具競標頁面
2. 點擊右側的「資料面板」按鈕
3. 使用搜尋功能快速定位資料
4. 點擊各種操作按鈕執行相應功能

### 匯出功能
- **匯出**: 匯出當前顯示的基本資料（編號、名稱、行政區、建立日期）
- **完整匯出**: 匯出所有欄位的完整資料
- **DL**: 分開下載 JSON 檔案和圖片檔案
- **PACK**: 打包下載，圖片轉為 Base64 格式包含在 JSON 中

### 自動填表
1. 點擊「新增」或「編輯」按鈕開啟表單
2. 點擊「匯入 JSON」按鈕
3. 選擇之前匯出的 JSON 檔案
4. 系統會自動填入所有資料並處理圖片上傳

### 遠端同步
1. 點擊「遠端匯入」按鈕
2. 選擇要匯入的檔案
3. 系統會批量處理並匯入資料

## 🔧 技術架構

### 檔案結構
```
furniture-helper/
├── manifest.json          # 擴充功能清單
├── content.js             # 主要內容腳本 (~1500行)
├── inject.js              # Vue 資料提取腳本 (~105行)
└── README.md              # 說明文件
```

### 資料結構 (tableFullData)
從 Vue 組件中提取的完整資料結構包含以下欄位：

#### 📊 基本資訊
- `AutoID`: 自動編號
- `ID`: 商品ID
- `Name`: 商品名稱
- `Description`: 商品描述
- `CategoryID`: 類別ID
- `CategoryName`: 類別名稱
- `DistID`: 行政區ID
- `DistName`: 行政區名稱

#### 💰 價格資訊
- `InitPrice`: 起標價格
- `OriginPrice`: 原價
- `CurrentPrice`: 目前價格
- `MinAddPrice`: 最低加價金額

#### 📅 時間資訊
- `CreateDate`: 建立日期
- `ModifyDate`: 修改日期
- `DeleteDate`: 刪除日期
- `StartDate`: 拍賣開始日期
- `EndDate`: 拍賣結束日期

#### 📏 尺寸資訊
- `Length`: 長度
- `Width`: 寬度
- `Height`: 高度
- `DeliveryAddress`: 交貨地點

#### 🏷️ 狀態資訊
- `IsFinish`: 是否結束
- `IsGet`: 是否已取貨
- `IsPay`: 是否已付款
- `PhotoVisible`: 圖片是否可見

#### 👥 用戶資訊
- `Account`: 帳號
- `AdminUser`: 管理員用戶
- `AdminUserID`: 管理員用戶ID
- `NickName`: 暱稱
- `WinnerID`: 得標者ID

#### 📈 統計資訊
- `BidCount`: 競標次數
- `HitCount`: 點擊次數
- `FAQCount`: FAQ數量
- `TrackCount`: 追蹤次數

#### 📋 關聯資料
- `Bids`: 競標記錄
- `FAQs`: FAQ記錄
- `Photos`: 圖片記錄
- `Payment`: 付款資訊
- `Refund`: 退款資訊

### 核心技術
- **Chrome Extension Manifest V3**: 現代化的擴充功能架構
- **Vue.js 資料存取**: 透過 `__vue__` 屬性存取頁面資料
- **Element UI 相容**: 完美整合 Element UI 組件
- **檔案處理**: Base64 轉換、CSV 生成、圖片處理
- **非同步操作**: Promise 和 async/await 模式

### 設計模式
- **統一樣式系統**: `COMMON_STYLES` 常數管理所有 UI 樣式
- **通知系統**: 統一的 `showNotification` 函數處理用戶提示
- **錯誤處理**: 簡化的錯誤處理機制，使用預設參數減少驗證
- **模組化函數**: 每個功能獨立封裝，便於維護

## 🎨 版本特色

### v2.0 優化重點
本版本經過大幅精簡和優化，主要改進包括：

#### 📦 代碼精簡 (減少 35% 代碼量)
- **移除裝飾性功能**: 清除所有 emoji、冗餘的 console.log 和無用註釋
- **簡化偵錯系統**: 大幅減少詳細日誌輸出，保留核心功能
- **移除邊緣功能**: 刪除很少使用的偵錯函數和空函數

#### 🎯 統一設計系統
- **CSS 樣式統一**: 所有 UI 元素使用 `COMMON_STYLES` 常數
- **通知系統標準化**: 替換 alert 彈窗為現代化通知
- **一致的錯誤處理**: 簡化驗證邏輯，使用預設參數

#### ⚡ 性能優化
- **資料驗證簡化**: 使用 `??` 運算符和預設參數
- **函數邏輯優化**: 移除非必要的複雜條件判斷
- **記憶體使用改善**: 簡化圖片處理和資料管理

## 🔍 功能詳解

### 資料處理流程
1. **資料擷取**: 透過 inject.js 從 Vue 組件取得資料
2. **資料處理**: 自動查詢競標記錄並整合資訊
3. **格式轉換**: 支援 CSV 和 JSON 格式輸出
4. **檔案操作**: Base64 圖片轉換和檔案下載

### 表單自動化
1. **欄位識別**: 自動識別表單欄位類型
2. **資料映射**: 將 JSON 資料對應到正確欄位
3. **圖片處理**: 自動轉換和上傳圖片
4. **驗證觸發**: 確保 Vue 響應式更新

### 錯誤處理機制
- **靜默處理**: 大部分錯誤採用靜默處理，不干擾用戶操作
- **備用方案**: 每個功能都有備用執行方案
- **用戶友好**: 重要錯誤通過通知系統告知用戶

## 🛠️ 開發資訊

### 相容性
- Chrome 88+ (Manifest V3 支援)
- 新北市政府環保局資源回收網站
- Element UI 2.x+ 框架
- Vue.js 2.x 框架

### 維護注意事項
- 定期檢查網站 DOM 結構變化
- 監控 Vue 組件更新對資料存取的影響
- 注意 Chrome 擴充功能 API 變更

### 已知限制
- 需要網站使用 Vue.js 框架
- 依賴特定的 CSS 類別名稱
- 需要 Chrome 瀏覽器環境

## 📈 使用統計

- **代碼行數**: ~1,600 行 (較前版本減少 35%)
- **核心函數**: 20+ 個主要功能函數
- **支援格式**: CSV, JSON, 圖片 (JPEG/PNG)
- **處理速度**: 單筆資料 < 500ms

## 🔄 更新日誌

### v2.1.0 (2025-07-22)
- ✅ 修復 CategoryID 一致性問題：PACK 匯出與直接匯入功能同步
- ✅ 新增 CATEGORY_MAPPING 常數，統一類別名稱與 ID 對應
- ✅ 改善 PACK 匯出：現在包含 CategoryID 資訊
- ✅ 智能 CategoryID 解析：支援中文類別名稱轉換為數字 ID
- ✅ 強化 directSubmitToAPI：使用智能 CategoryID 邏輯取代固定預設值
- ✅ 優化表單填入功能：支援 CategoryID 反向查詢類別名稱
- ✅ 修正預設拍賣期限：從 30 天調整為 14 天（兩周）

### v2.0.0 (2025-07-13)
- ✅ 大幅精簡代碼，移除 35% 冗餘內容
- ✅ 統一 CSS 樣式系統，提升 UI 一致性
- ✅ 簡化錯誤處理，改善用戶體驗
- ✅ 移除裝飾性功能，專注核心功能
- ✅ 優化資料驗證邏輯
- ✅ 修復 PACK/DL 按鈕功能對應問題

### v1.x.x (歷史版本)
- 基礎功能實現
- Vue 資料存取機制
- 檔案匯出入功能

## 📞 技術支援

如有問題或建議，請檢查：
1. Chrome 開發者工具的 Console 錯誤訊息
2. 確認網站頁面已完全載入
3. 檢查擴充功能是否正確安裝並啟用

---

**開發團隊**: 致力於提供高效、穩定的家具競標管理解決方案
**最後更新**: 2025年7月22日