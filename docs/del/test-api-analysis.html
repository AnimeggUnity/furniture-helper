<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIç«¯é»åˆ†ææ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .console-output {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .api-info {
            background: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
        }
        .mock-api {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” APIç«¯é»åˆ†ææ¸¬è©¦é é¢</h1>
        
        <div class="api-info">
            <h3>ğŸ“‹ æ¸¬è©¦èªªæ˜</h3>
            <p>é€™å€‹é é¢æ¨¡æ“¬äº†å®¶å…·æ‹è³£ç¶²çš„ç’°å¢ƒï¼ŒåŒ…å«ï¼š</p>
            <ul>
                <li>Vue.jsçµ„ä»¶çµæ§‹</li>
                <li>æ¨¡æ“¬çš„APIç«¯é»</li>
                <li>ç«¶æ¨™ç´€éŒ„æŒ‰éˆ•</li>
                <li>ç¶²è·¯è«‹æ±‚æ””æˆª</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ æ¨¡æ“¬ç«¶æ¨™ç´€éŒ„æŒ‰éˆ•</h3>
            <button class="test-button" onclick="simulateBidButton()">
                ğŸ” ç«¶æ¨™ç´€éŒ„
            </button>
            <button class="test-button" onclick="simulateBidButtonWithAPI()">
                ğŸ” ç«¶æ¨™ç´€éŒ„ (å«APIå‘¼å«)
            </button>
        </div>

        <div class="test-section">
            <h3>ğŸŒ æ¨¡æ“¬APIç«¯é»</h3>
            <div class="mock-api">
                <strong>GET /api/bid/history/{id}</strong> - å–å¾—ç«¶æ¨™ç´€éŒ„
            </div>
            <div class="mock-api">
                <strong>POST /api/bid/search</strong> - æœå°‹ç«¶æ¨™è³‡æ–™
            </div>
            <div class="mock-api">
                <strong>GET /api/furniture/{id}/bids</strong> - å–å¾—å®¶å…·å‡ºåƒ¹ç´€éŒ„
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š Consoleè¼¸å‡º</h3>
            <div id="console-output" class="console-output">
                ç­‰å¾…æ¸¬è©¦é–‹å§‹...
            </div>
            <button class="test-button" onclick="clearConsole()">æ¸…é™¤è¼¸å‡º</button>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ æ‰‹å‹•æ¸¬è©¦æŒ‡ä»¤</h3>
            <p>åœ¨ç€è¦½å™¨Consoleä¸­åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š</p>
            <div class="console-output">
// è§¸ç™¼APIç«¯é»åˆ†æ
window.postMessage({ source: 'run-vue-api-endpoint-analysis' }, '*');

// è§¸ç™¼ç«¶æ¨™ç´€éŒ„åˆ†æ
window.postMessage({ source: 'run-vue-bid-history-analysis' }, '*');

// è‡ªå‹•é»æ“Šç«¶æ¨™æŒ‰éˆ•
window.postMessage({ source: 'run-vue-auto-click-bid-button' }, '*');
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ“¬Vueçµ„ä»¶
        class MockVueComponent {
            constructor() {
                this.$data = {
                    bidHistory: [],
                    apiEndpoint: '/api/bid/history',
                    furnitureId: 12345
                };
                this.$options = {
                    methods: {
                        fetchBidHistory: function(id) {
                            console.log('ğŸ¯ Vueæ–¹æ³•: fetchBidHistory è¢«å‘¼å«ï¼Œåƒæ•¸:', id);
                            return fetch(`/api/bid/history/${id}`);
                        },
                        searchBids: function(params) {
                            console.log('ğŸ¯ Vueæ–¹æ³•: searchBids è¢«å‘¼å«ï¼Œåƒæ•¸:', params);
                            return fetch('/api/bid/search', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(params)
                            });
                        }
                    }
                };
            }
        }

        // æ¨¡æ“¬Vueå¯¦ä¾‹
        const mockVue = new MockVueComponent();
        document.body.__vue__ = mockVue;

        // æ¨¡æ“¬ç«¶æ¨™ç´€éŒ„æŒ‰éˆ•
        function simulateBidButton() {
            logToConsole('ğŸ” æ¨¡æ“¬ç«¶æ¨™ç´€éŒ„æŒ‰éˆ•é»æ“Š');
            
            // æ¨¡æ“¬è·³çª—å‡ºç¾
            setTimeout(() => {
                logToConsole('âœ… è·³çª—å·²å‡ºç¾');
                logToConsole('ğŸ“‹ è·³çª—å…§å®¹: å‡ºåƒ¹ç´€éŒ„è¡¨æ ¼');
                logToConsole('ğŸ’° æ‰¾åˆ°åƒ¹æ ¼: 18å…ƒ');
                logToConsole('ğŸ‘¤ å‡ºåƒ¹äºº: Tank (animegg)');
                logToConsole('â° å‡ºåƒ¹æ™‚é–“: 2025-07-07 15:54');
            }, 500);
        }

        // æ¨¡æ“¬ç«¶æ¨™ç´€éŒ„æŒ‰éˆ•ï¼ˆå«APIå‘¼å«ï¼‰
        function simulateBidButtonWithAPI() {
            logToConsole('ğŸ” æ¨¡æ“¬ç«¶æ¨™ç´€éŒ„æŒ‰éˆ•é»æ“Šï¼ˆå«APIå‘¼å«ï¼‰');
            
            // æ¨¡æ“¬APIå‘¼å«
            setTimeout(() => {
                logToConsole('ğŸŒ ç™¼é€APIè«‹æ±‚: GET /api/bid/history/12345');
                logToConsole('ğŸ“¦ è«‹æ±‚åƒæ•¸: { furnitureId: 12345 }');
                
                // æ¨¡æ“¬APIå›æ‡‰
                setTimeout(() => {
                    logToConsole('âœ… APIå›æ‡‰æ”¶åˆ°');
                    logToConsole('ğŸ“‹ å›æ‡‰è³‡æ–™:');
                    logToConsole('  - å‡ºåƒ¹äºº: Tank (animegg)');
                    logToConsole('  - åƒ¹æ ¼: 18');
                    logToConsole('  - æ™‚é–“: 2025-07-07T15:54:00Z');
                    logToConsole('  - ç‹€æ…‹: æˆåŠŸ');
                }, 300);
            }, 200);
        }

        // æ””æˆªfetchè«‹æ±‚
        const originalFetch = window.fetch;
        window.fetch = function(...args) {
            const url = args[0];
            const options = args[1] || {};
            
            logToConsole(`ğŸŒ Fetchè«‹æ±‚: ${options.method || 'GET'} ${url}`);
            
            if (typeof url === 'string' && 
                (url.includes('bid') || url.includes('history') || url.includes('api'))) {
                logToConsole(`ğŸ¯ ç™¼ç¾ç«¶æ¨™ç›¸é—œAPIè«‹æ±‚: ${url}`);
            }
            
            return originalFetch.apply(this, args);
        };

        // æ””æˆªXMLHttpRequest
        const originalXHROpen = XMLHttpRequest.prototype.open;
        const originalXHRSend = XMLHttpRequest.prototype.send;
        
        XMLHttpRequest.prototype.open = function(method, url, ...args) {
            this._method = method;
            this._url = url;
            return originalXHROpen.apply(this, [method, url, ...args]);
        };
        
        XMLHttpRequest.prototype.send = function(data) {
            logToConsole(`ğŸŒ XHRè«‹æ±‚: ${this._method} ${this._url}`);
            
            if (typeof this._url === 'string' && 
                (this._url.includes('bid') || this._url.includes('history') || this._url.includes('api'))) {
                logToConsole(`ğŸ¯ ç™¼ç¾ç«¶æ¨™ç›¸é—œXHRè«‹æ±‚: ${this._url}`);
            }
            
            return originalXHRSend.apply(this, [data]);
        };

        // Consoleè¼¸å‡ºå‡½æ•¸
        function logToConsole(message) {
            const consoleOutput = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            consoleOutput.innerHTML += `[${timestamp}] ${message}<br>`;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            
            // åŒæ™‚è¼¸å‡ºåˆ°ç€è¦½å™¨Console
            console.log(message);
        }

        // æ¸…é™¤Consoleè¼¸å‡º
        function clearConsole() {
            document.getElementById('console-output').innerHTML = 'Consoleå·²æ¸…é™¤...';
        }

        // ç›£è½postMessage
        window.addEventListener('message', event => {
            if (event.source !== window) return;
            
            const source = event.data?.source;
            if (source === 'run-vue-api-endpoint-analysis') {
                logToConsole('ğŸ” é–‹å§‹APIç«¯é»åˆ†æ...');
                
                // æ¨¡æ“¬Vueå¯¦ä¾‹åˆ†æ
                setTimeout(() => {
                    logToConsole('ğŸ“‹ æ­¥é©Ÿ1: åˆ†æVueçµ„ä»¶ä¸­çš„APIå‘¼å«');
                    logToConsole('âœ… æ‰¾åˆ° 1 å€‹Vueå¯¦ä¾‹');
                    logToConsole('ğŸ¯ ç™¼ç¾APIæ–¹æ³•: fetchBidHistory');
                    logToConsole('ğŸ¯ ç™¼ç¾APIæ–¹æ³•: searchBids');
                    logToConsole('ğŸ¯ ç™¼ç¾APIç›¸é—œè³‡æ–™: apiEndpoint = /api/bid/history');
                }, 500);
                
                // æ¨¡æ“¬APIç«¯é»æœå°‹
                setTimeout(() => {
                    logToConsole('ğŸ“‹ æ­¥é©Ÿ3: åˆ†æé é¢ä¸­çš„APIç«¯é»');
                    logToConsole('ğŸ¯ ç™¼ç¾APIç«¯é»: /api/bid/history/{id}');
                    logToConsole('ğŸ¯ ç™¼ç¾APIç«¯é»: /api/bid/search');
                    logToConsole('ğŸ¯ ç™¼ç¾APIç«¯é»: /api/furniture/{id}/bids');
                }, 1000);
                
                // æ¨¡æ“¬æŒ‰éˆ•é»æ“Š
                setTimeout(() => {
                    logToConsole('ğŸ“‹ æ­¥é©Ÿ5: è§¸ç™¼ç«¶æ¨™ç´€éŒ„æŒ‰éˆ•é»æ“Š');
                    logToConsole('ğŸ¯ é»æ“Šç«¶æ¨™ç´€éŒ„æŒ‰éˆ•...');
                    simulateBidButtonWithAPI();
                }, 1500);
            }
        });

        // é é¢è¼‰å…¥å®Œæˆ
        window.addEventListener('load', () => {
            logToConsole('âœ… æ¸¬è©¦é é¢è¼‰å…¥å®Œæˆ');
            logToConsole('ğŸ”§ ç¶²è·¯è«‹æ±‚æ””æˆªå™¨å·²è¨­å®š');
            logToConsole('ğŸ’¡ è«‹é»æ“Šä¸Šæ–¹æŒ‰éˆ•æˆ–ä½¿ç”¨ConsoleæŒ‡ä»¤é€²è¡Œæ¸¬è©¦');
        });
    </script>
</body>
</html> 